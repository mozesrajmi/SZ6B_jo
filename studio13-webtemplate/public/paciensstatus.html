<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Páciens Státuszok</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.3/css/dataTables.dataTables.css" />
    <script src="https://cdn.datatables.net/2.0.3/js/dataTables.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link rel="stylesheet" href="paciensstaus.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark ">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Páciens Státuszok</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#waiting">Várakozók</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#precare">Előgondozottak</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#treated">Ellátottak</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#left">Távozottak</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">

        <!-- Várakozók -->
        <h2 id="waiting" class="text-center">Várakozók</h2>
        <table id="myTable" class="display col-md-8">
            <thead>
                <tr>
                    <th>Név</th>
                    <th>TAJ</th>
                    <th>Felvétel Dátuma</th>
                    <th>Sürgős</th>
                </tr>
            </thead>
            <tbody id="waiting-list">
                <!-- Várakozók adatok -->
            </tbody>
        </table>

        <!-- Előgondozottak -->
        <h2 id="precare"  class="text-center">Előgondozottak</h2>
        <table id="myTable" class="display" style="width:60%">
            <thead>
                <tr>
                    <th>Név</th>
                    <th>TAJ</th>
                    <th>Előgondozás Dátuma</th>
                </tr>
            </thead>
            <tbody id="precare-list">
                <!-- Előgondozottak adatok -->
            </tbody>
        </table>

        <!-- Ellátottak -->
        <h2 id="treated"  class="text-center">Ellátottak</h2>
        <table id="myTable" class="display" style="width:60%">
            <thead>
                <tr>
                    <th>Név</th>
                    <th>TAJ</th>
                    <th>Ellátás Dátuma</th>
                </tr>
            </thead>
            <tbody id="treated-list">
                <!-- Ellátottak adatok -->
            </tbody>
        </table>

        <!-- Távozottak -->
        <h2 id="left"  class="text-center">Távozottak</h2>
        <table id="myTable" class="display" style="width:60%">
            <thead>
                <tr>
                    <th>Név</th>
                    <th>TAJ</th>
                    <th>Távozás Dátuma</th>
                </tr>
            </thead>
            <tbody id="left-list">
                <!-- Távozottak adatok -->
            </tbody>
        </table>
    </div>

    <script>
        // Helper function to fetch and populate data
        const fetchData = (status, tableId) => {
            fetch(`/getPatientsByStatus?status=${status}`)
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById(tableId);
                    tableBody.innerHTML = ''; // Clear existing rows
                    data.rows.forEach(patient => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${patient.NEV}</td>
                            <td>${patient.TAJ}</td>
                            <td>${patient.DATUM}</td>
                            ${status === 'Várakozó' ? `<td>${patient.SURGOS_VARAKOZO === 'Y' ? 'Igen' : 'Nem'}</td>` : ''}
                        `;
                        tableBody.appendChild(row);
                    });
                })
                .catch(err => console.error(`Hiba a ${status} adatok betöltésekor:`, err));
        };

        // Fetch data for all statuses
        fetchData('Várakozó', 'waiting-list');
        fetchData('Előgondozott', 'precare-list');
        fetchData('Ellátott', 'treated-list');
        fetchData('Távozott', 'left-list');
    </script>
</body>
</html>